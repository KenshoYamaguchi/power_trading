{% extends "base.html" %}

{% block content %}
<div class="hero">
    <h1>é›»åŠ›å£²è²·ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </h1>
    <p>ä½™ã£ãŸé›»åŠ›ã‚’å£²ã£ãŸã‚Šã€å¿…è¦ãªé›»åŠ›ã‚’è³¼å…¥ã§ãã‚‹ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹</p>
    <div class="hero-buttons">
        {% if current_user.is_authenticated %}
            <a href="{{ url_for('main.new_listing') }}" class="btn btn-success">é›»åŠ›ã‚’å‡ºå“ã™ã‚‹</a>
            <a href="{{ url_for('main.new_request') }}" class="btn btn-primary">è²·å–ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</a>
        {% else %}
            <a href="{{ url_for('auth.register') }}" class="btn btn-success">ä»Šã™ãå§‹ã‚ã‚‹</a>
            <a href="{{ url_for('main.listings') }}" class="btn btn-secondary">å‡ºå“ã‚’è¦‹ã‚‹</a>
        {% endif %}
    </div>
</div>

<div class="stats">
    <div class="stat-item">
        <div class="stat-number">{{ listings|length }}</div>
        <div class="stat-label">å‡ºå“ä¸­</div>
    </div>
    <div class="stat-item">
        <div class="stat-number">{{ requests|length }}</div>
        <div class="stat-label">è²·å–ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</div>
    </div>
    <div class="stat-item">
        <div class="stat-number">100+</div>
        <div class="stat-label">ãƒ¦ãƒ¼ã‚¶ãƒ¼</div>
    </div>
</div>

<h2 class="section-title">æœ€æ–°ã®å‡ºå“</h2>
<div class="card-grid">
    {% for listing in listings %}
        <div class="card">
            <h3><a href="{{ url_for('main.listing_detail', id=listing.id) }}" style="text-decoration: none; color: inherit;">{{ listing.title }}</a></h3>
            <p>{{ listing.description[:100] }}{% if listing.description|length > 100 %}...{% endif %}</p>
            <div class="listing-meta">
                <span>ğŸ”‹ {{ listing.power_amount }}kWh</span>
                <span>ğŸ“ {{ listing.location }}</span>
                <span>ğŸ‘¤ {{ listing.seller.username }}</span>
            </div>
            <div class="price">Â¥{{ "%.2f"|format(listing.price_per_kwh) }}/kWh</div>
        </div>
    {% else %}
        <p>ç¾åœ¨å‡ºå“ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    {% endfor %}
</div>

<h2 class="section-title">æœ€æ–°ã®è²·å–ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</h2>
<div class="card-grid">
    {% for request in requests %}
        <div class="card">
            <h3><a href="{{ url_for('main.request_detail', id=request.id) }}" style="text-decoration: none; color: inherit;">{{ request.title }}</a></h3>
            <p>{{ request.description[:100] }}{% if request.description|length > 100 %}...{% endif %}</p>
            <div class="listing-meta">
                <span>ğŸ”‹ {{ request.power_amount }}kWh</span>
                <span>ğŸ“ {{ request.location }}</span>
                <span>ğŸ‘¤ {{ request.buyer.username }}</span>
            </div>
            <div class="price">æœ€å¤§ Â¥{{ "%.2f"|format(request.max_price_per_kwh) }}/kWh</div>
        </div>
    {% else %}
        <p>ç¾åœ¨è²·å–ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    {% endfor %}
</div>
{% endblock %}